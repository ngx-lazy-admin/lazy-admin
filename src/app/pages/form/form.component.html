<!-- <nz-spin *ngIf="loading" [nzSpinning]="loading" class="p-5"></nz-spin> -->

<ng-container *ngIf="!loading && form">
	<ng-container  *ngIf="status == 200">

		<nz-alert
			nzType="info"
			class="mb-3"
			nzCloseable
			nzDescription="键盘点击 . , 可以编辑当前页面配置"
		></nz-alert>

		<nz-page-header *ngIf="info" class="bg-white mb-3">
			<nz-page-header-title>{{info?.title}}</nz-page-header-title>
			<nz-page-header-content>
				{{info?.content}}
			</nz-page-header-content>
		</nz-page-header>
		<form [formGroup]="form" (ngSubmit)="submit()">
			<formly-form 
				class="row" 
				[form]="form" 
				[fields]="fields" 
				[(model)]="model"
				[options]="options">
				<button nz-button type="submit">提交</button>
			</formly-form>
		</form>
	</ng-container>

	<ng-container *ngIf="status == 403">
		<nz-result nzStatus="403" nzTitle="403" nzSubTitle="Sorry, you are not authorized to access this page.">
			<div nz-result-extra>
				<button nz-button nzType="primary">Back Home</button>
			</div>
		</nz-result>
	</ng-container>

	<ng-container *ngIf="status == 404">
		<nz-result nzStatus="404" nzTitle="404" nzSubTitle="Sorry, the page you visited does not exist.">
			<div nz-result-extra>
				<button nz-button [routerLink]="'dashboard/analysis'" nzType="primary">Back Home</button>
			</div>
		</nz-result>
	</ng-container>

	<ng-container *ngIf="status == 500">
		<nz-result nzStatus="500" nzTitle="500" nzSubTitle="Sorry, there is an error on server.">
			<div nz-result-extra>
				<button nz-button nzType="primary">Back Home</button>
			</div>
		</nz-result>
	</ng-container>
</ng-container>

<nz-drawer
	[nzClosable]="false"
	[nzVisible]="isVisible"
	[nzPlacement]="'top'"
	[nzHeight]="'100vh'"
>
<ng-container *nzDrawerContent>
	<!-- <div class="row mb-3">
		<div class="col-6">
			<button nz-button class="me-2" nzType="primary">
				<i nz-icon nzType="download"></i>
			</button>
			<button nz-button class="me-2" nzType="primary">
				<i nz-icon nzType="download"></i>
			</button>
			<button nz-button class="me-2" nzType="primary">
				<i nz-icon nzType="download"></i>
			</button>
			<button nz-button class="me-2" nzType="primary">
				<i nz-icon nzType="download"></i>
			</button>
		</div>
	</div>  -->
	<div class="row" style="height: 100%;">
		<div class="col-6" style="height: 100%; position: relative;">

			<nz-tabset  style="height: 100%; position: relative;">
				<nz-tab nzTitle="Fields"  style="height: 100vh;  position: relative;">
					<nz-code-editor 
						class="editor" 
						style="height: 100vh;"
						[nzEditorMode]="'normal'"
						[ngModel]="code"
						[nzEditorOption]="{ 
							language: codeType
						}" 
						(nzEditorInitialized)="editorInitialized($event)">
					</nz-code-editor>
				</nz-tab>
				<nz-tab nzTitle="Model">
				  <pre> {{ model | json}}</pre>
				</nz-tab>
			  </nz-tabset>
		</div>
		<form [formGroup]="form" class="col-6 w-50">
			<formly-form 
				class="row " 
				[form]="form" 
				[fields]="fields" 
				[model]="model"
				[options]="options">
			</formly-form>
		</form>
	</div>
</ng-container>
</nz-drawer>